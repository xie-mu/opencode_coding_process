# Music Vocal Concert å¼€å‘å®æ–½æŒ‡å—

## 1. å¼€å‘ç¯å¢ƒæ­å»º

### 1.1 ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Linux/macOS/Windows (WSL2)
- **å†…å­˜**: 8GB+
- **å­˜å‚¨**: 50GB+
- **ç½‘ç»œ**: ç¨³å®šç½‘ç»œè¿æ¥

### 1.2 å¼€å‘å·¥å…·å®‰è£…

#### 1.2.1 å®‰è£…Python 3.9+
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3.9 python3.9-venv python3.9-dev

# macOS (ä½¿ç”¨Homebrew)
brew install python@3.9

# Windows
# ä»python.orgä¸‹è½½å®‰è£…åŒ…
```

#### 1.2.2 å®‰è£…Node.js 16+
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt-get install -y nodejs

# macOS (ä½¿ç”¨Homebrew)
brew install node@16

# Windows
# ä»nodejs.orgä¸‹è½½å®‰è£…åŒ…
```

#### 1.2.3 å®‰è£…Docker
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install docker.io docker-compose

# macOS (ä½¿ç”¨Docker Desktop)
# ä»docker.comä¸‹è½½å®‰è£…åŒ…

# Windows (ä½¿ç”¨Docker Desktop)
# ä»docker.comä¸‹è½½å®‰è£…åŒ…
```

### 1.3 é¡¹ç›®å…‹éš†å’Œåˆå§‹åŒ–

#### 1.3.1 å…‹éš†é¡¹ç›®
```bash
# å…‹éš†é¡¹ç›®ä»“åº“
git clone https://github.com/your-org/music-vocal-concert.git
cd music-vocal-concert

# åˆ›å»ºå¼€å‘åˆ†æ”¯
git checkout -b develop
```

#### 1.3.2 å®‰è£…Pythonä¾èµ–
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.9 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\\Scripts\\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 1.3.3 å®‰è£…Node.jsä¾èµ–
```bash
# å®‰è£…ä¾èµ–
npm install

# å®‰è£…å¼€å‘ä¾èµ–
npm install --save-dev @types/react @types/react-dom typescript
```

### 1.4 æ•°æ®åº“é…ç½®

#### 1.4.1 å®‰è£…PostgreSQL
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install postgresql postgresql-contrib

# macOS (ä½¿ç”¨Homebrew)
brew install postgresql

# å¯åŠ¨æœåŠ¡
sudo service postgresql start  # Ubuntu/Debian
brew services start postgresql  # macOS
```

#### 1.4.2 å®‰è£…MongoDB
```bash
# Ubuntu/Debian
wget -qO - https://www.mongodb.org/static/pgp/server-5.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/5.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-5.0.list
sudo apt update
sudo apt install -y mongodb-org

# macOS (ä½¿ç”¨Homebrew)
brew tap mongodb/brew
brew install mongodb-community

# å¯åŠ¨æœåŠ¡
sudo service mongodb start  # Ubuntu/Debian
brew services start mongodb-community  # macOS
```

#### 1.4.3 åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
```bash
# PostgreSQL
sudo -u postgres psql
CREATE DATABASE music_vocal_concert;
CREATE USER music_user WITH PASSWORD 'secure_password';
GRANT ALL PRIVILEGES ON DATABASE music_vocal_concert TO music_user;
\q

# MongoDB
mongo
use music_vocal_concert
db.createUser({
  user: "music_user",
  pwd: "secure_password",
  roles: ["readWrite", "dbAdmin"]
})
exit
```

### 1.5 ç¯å¢ƒå˜é‡é…ç½®

#### 1.5.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
cp .env.example .env

# ä¿®æ”¹é…ç½®
nano .env
```

#### 1.5.2 ç¯å¢ƒå˜é‡å†…å®¹
```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://music_user:secure_password@localhost:5432/music_vocal_concert
MONGODB_URI=mongodb://localhost:27017/music_vocal_concert

# APIé…ç½®
API_KEY=your_api_key_here
SECRET_KEY=your_secret_key_here
JWT_SECRET=your_jwt_secret_here

# çˆ¬è™«é…ç½®
CRAWLER_DELAY=1.0
MAX_RETRIES=3
TIMEOUT=30

# éƒ¨ç½²é…ç½®
ENVIRONMENT=development
DEBUG=True
PORT=8000

# Redisé…ç½®
REDIS_URL=redis://localhost:6379/0

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=app.log
```

## 2. å¼€å‘æµç¨‹

### 2.1 Gitå·¥ä½œæµ

#### 2.1.1 åˆ†æ”¯ç­–ç•¥
- **main**: ç”Ÿäº§ç¯å¢ƒä»£ç 
- **develop**: å¼€å‘ç¯å¢ƒä»£ç 
- **feature/xxx**: åŠŸèƒ½å¼€å‘åˆ†æ”¯
- **bugfix/xxx**: Bugä¿®å¤åˆ†æ”¯
- **hotfix/xxx**: ç´§æ€¥ä¿®å¤åˆ†æ”¯

#### 2.1.2 æäº¤è§„èŒƒ
```bash
# åŠŸèƒ½å¼€å‘
git checkout -b feature/user-authentication
# å¼€å‘å®Œæˆå
git add .
git commit -m "feat: æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½"
git push origin feature/user-authentication

# Bugä¿®å¤
git checkout -b bugfix/login-issue
# ä¿®å¤å®Œæˆå
git add .
git commit -m "fix: ä¿®å¤ç™»å½•é¡µé¢æ ·å¼é—®é¢˜"
git push origin bugfix/login-issue
```

#### 2.1.3 ä»£ç å®¡æŸ¥
```bash
# åˆ›å»ºPull Request
# åœ¨GitHub/GitLabä¸Šåˆ›å»ºPR
# ç­‰å¾…ä»£ç å®¡æŸ¥
# å®¡æŸ¥é€šè¿‡ååˆå¹¶
```

### 2.2 ä»£ç è§„èŒƒ

#### 2.2.1 Pythonä»£ç è§„èŒƒ
- **PEP8**: éµå¾ªPEP8ä»£ç è§„èŒƒ
- **ç±»å‹æ³¨è§£**: ä½¿ç”¨ç±»å‹æ³¨è§£
- **æ–‡æ¡£å­—ç¬¦ä¸²**: å®Œæ•´çš„æ–‡æ¡£å­—ç¬¦ä¸²
- **æµ‹è¯•è¦†ç›–**: é«˜æµ‹è¯•è¦†ç›–ç‡

#### 2.2.2 JavaScript/TypeScriptä»£ç è§„èŒƒ
- **ESLint**: ä½¿ç”¨ESLintæ£€æŸ¥
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **TypeScript**: ä½¿ç”¨TypeScript
- **ç»„ä»¶è§„èŒƒ**: ç»„ä»¶å‘½åå’Œç»“æ„è§„èŒƒ

### 2.3 å¼€å‘æµç¨‹

#### 2.3.1 åŠŸèƒ½å¼€å‘æµç¨‹
1. **åˆ›å»ºåˆ†æ”¯**: `git checkout -b feature/xxx`
2. **ç¼–å†™ä»£ç **: æŒ‰ç…§è§„èŒƒç¼–å†™ä»£ç 
3. **ç¼–å†™æµ‹è¯•**: ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
4. **ä»£ç å®¡æŸ¥**: æäº¤PRè¿›è¡Œä»£ç å®¡æŸ¥
5. **åˆå¹¶ä»£ç **: å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ°developåˆ†æ”¯

#### 2.3.2 Bugä¿®å¤æµç¨‹
1. **åˆ›å»ºåˆ†æ”¯**: `git checkout -b bugfix/xxx`
2. **å®šä½é—®é¢˜**: ä½¿ç”¨è°ƒè¯•å·¥å…·å®šä½é—®é¢˜
3. **ä¿®å¤ä»£ç **: ä¿®å¤é—®é¢˜å¹¶æ·»åŠ æµ‹è¯•
4. **ä»£ç å®¡æŸ¥**: æäº¤PRè¿›è¡Œä»£ç å®¡æŸ¥
5. **åˆå¹¶ä»£ç **: å®¡æŸ¥é€šè¿‡ååˆå¹¶

## 3. ä»£ç å¼€å‘

### 3.1 å‰ç«¯å¼€å‘

#### 3.1.1 ç»„ä»¶å¼€å‘
```typescript
// æ¼”å”±ä¼šå¡ç‰‡ç»„ä»¶
import React from 'react';
import styled from 'styled-components';

interface ConcertCardProps {
  concert: Concert;
  onSelect: (concert: Concert) => void;
}

const ConcertCard: React.FC<ConcertCardProps> = ({ concert, onSelect }) => {
  return (
    <Card onClick={() => onSelect(concert)}>
      <Title>{concert.name}</Title>
      <Artist>{concert.artist}</Artist>
      <City>{concert.city}</City>
      <Date>{formatDate(concert.date)}</Date>
    </Card>
  );
};

export default ConcertCard;
```

#### 3.1.2 APIæœåŠ¡
```typescript
// APIæœåŠ¡
import axios from 'axios';

const api = axios.create({
  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:8000/api',
  timeout: 10000,
});

export const concertApi = {
  getConcerts: (params?: ConcertQuery) => 
    api.get('/concerts', { params }),
  
  getConcert: (id: number) => 
    api.get(`/concerts/${id}`),
  
  searchConcerts: (query: string) => 
    api.get('/search', { params: { query } }),
};
```

### 3.2 åç«¯å¼€å‘

#### 3.2.1 æ¨¡å‹å¼€å‘
```python
# æ¼”å”±ä¼šæ¨¡å‹
from pydantic import BaseModel
from datetime import datetime
from enum import Enum

class Region(str, Enum):
    MAINLAND = "mainland"
    HONGKONG = "hongkong"
    MACAO = "macao"
    TAIWAN = "taiwan"

class ConcertCreate(BaseModel):
    name: str
    artist: str
    city: str
    region: Region
    date: datetime
    address: str
    venue: str
    platform: ConcertPlatform
    price_range: Optional[str] = None
    duration: Optional[int] = None
    concert_type: Optional[str] = None
    description: Optional[str] = None
```

#### 3.2.2 æœåŠ¡å¼€å‘
```python
# æ¼”å”±ä¼šæœåŠ¡
from fastapi import Depends, HTTPException
from sqlalchemy.ext.asyncio import AsyncSession
from .models import Concert
from .database import get_db_session

class ConcertService:
    def __init__(self):
        self.db_session = None

    async def get_concerts(self, city: str = None, artist: str = None):
        """è·å–æ¼”å”±ä¼šåˆ—è¡¨"""
        query = select(Concert)
        
        if city:
            query = query.where(Concert.city.ilike(f"%{city}%"))
        if artist:
            query = query.where(Concert.artist.ilike(f"%{artist}%"))
            
        result = await self.db_session.execute(query)
        return result.scalars().all()
```

#### 3.2.3 APIå¼€å‘
```python
# APIè·¯ç”±
from fastapi import APIRouter, Depends
from .services.concert_service import ConcertService

router = APIRouter()

@router.get("/concerts")
async def get_concerts(
    city: str = None,
    artist: str = None,
    concert_service: ConcertService = Depends(get_concert_service)
):
    """è·å–æ¼”å”±ä¼šåˆ—è¡¨"""
    concerts = await concert_service.get_concerts(city, artist)
    return concerts
```

### 3.3 æ•°æ®æŠ“å–å¼€å‘

#### 3.3.1 çˆ¬è™«å¼€å‘
```python
# å¤§éº¦ç½‘çˆ¬è™«
import scrapy
from scrapy.crawler import CrawlerProcess
from .items import ConcertItem

class DamaiSpider(scrapy.Spider):
    name = 'damai'
    start_urls = ['https://www.damai.cn/concerts']
    
    def parse(self, response):
        for concert in response.css('.concert-item'):
            item = ConcertItem()
            item['name'] = concert.css('.title::text').get()
            item['artist'] = concert.css('.artist::text').get()
            item['city'] = concert.css('.city::text').get()
            yield item
```

#### 3.3.2 æ•°æ®è§£æ
```python
# æ•°æ®è§£æå™¨
import re
from datetime import datetime

class DataParser:
    @staticmethod
    def parse_date(date_str: str) -> datetime:
        """è§£ææ—¥æœŸå­—ç¬¦ä¸²"""
        patterns = [
            r'(\d{4})-(\d{2})-(\d{2})',
            r'(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥'
        ]
        
        for pattern in patterns:
            match = re.search(pattern, date_str)
            if match:
                if len(match.groups()) == 3:
                    year, month, day = match.groups()
                    return datetime(int(year), int(month), int(day))
        return None
```

## 4. æµ‹è¯•å¼€å‘

### 4.1 å‰ç«¯æµ‹è¯•

#### 4.1.1 å•å…ƒæµ‹è¯•
```typescript
// æ¼”å”±ä¼šå¡ç‰‡ç»„ä»¶æµ‹è¯•
import { render, screen } from '@testing-library/react';
import ConcertCard from './ConcertCard';

test('renders concert information', () => {
  const concert = {
    id: 1,
    name: 'å‘¨æ°ä¼¦æ¼”å”±ä¼š',
    artist: 'å‘¨æ°ä¼¦',
    city: 'åŒ—äº¬',
    date: '2026-03-15'
  };
  
  render(<ConcertCard concert={concert} onSelect={() => {}} />);
  
  expect(screen.getByText('å‘¨æ°ä¼¦æ¼”å”±ä¼š')).toBeInTheDocument();
  expect(screen.getByText('å‘¨æ°ä¼¦')).toBeInTheDocument();
  expect(screen.getByText('åŒ—äº¬')).toBeInTheDocument();
});
```

#### 4.1.2 é›†æˆæµ‹è¯•
```typescript
// APIæœåŠ¡æµ‹è¯•
import { concertApi } from './api/concertApi';

test('fetches concerts successfully', async () => {
  const concerts = await concertApi.getConcerts();
  expect(concerts.data).toBeInstanceOf(Array);
  expect(concerts.data.length).toBeGreaterThan(0);
});
```

### 4.2 åç«¯æµ‹è¯•

#### 4.2.1 å•å…ƒæµ‹è¯•
```python
# æ¼”å”±ä¼šæœåŠ¡æµ‹è¯•
import pytest
from unittest.mock import Mock
from .services.concert_service import ConcertService

@pytest.fixture
def mock_db_session():
    return Mock()

@pytest.fixture
def concert_service(mock_db_session):
    service = ConcertService()
    service.db_session = mock_db_session
    return service

@pytest.mark.asyncio
async def test_get_concerts(concert_service, mock_db_session):
    # æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢ç»“æœ
    mock_result = Mock()
    mock_result.scalars.return_value.all.return_value = [
        {'id': 1, 'name': 'æ¼”å”±ä¼š1'},
        {'id': 2, 'name': 'æ¼”å”±ä¼š2'}
    ]
    
    mock_db_session.execute.return_value = mock_result
    
    concerts = await concert_service.get_concerts()
    assert len(concerts) == 2
    assert concerts[0]['name'] == 'æ¼”å”±ä¼š1'
```

#### 4.2.2 é›†æˆæµ‹è¯•
```python
# APIé›†æˆæµ‹è¯•
import pytest
from fastapi.testclient import TestClient
from .main import app

client = TestClient(app)

def test_get_concerts():
    response = client.get("/api/concerts")
    assert response.status_code == 200
    assert response.json() == []

def test_create_concert():
    concert_data = {
        "name": "å‘¨æ°ä¼¦æ¼”å”±ä¼š",
        "artist": "å‘¨æ°ä¼¦",
        "city": "åŒ—äº¬",
        "region": "mainland",
        "date": "2026-03-15T20:00:00",
        "address": "åŒ—äº¬å·¥äººä½“è‚²é¦†",
        "venue": "åŒ—äº¬å·¥äººä½“è‚²é¦†",
        "platform": "damai"
    }
    
    response = client.post("/api/concerts", json=concert_data)
    assert response.status_code == 200
    assert response.json()["name"] == "å‘¨æ°ä¼¦æ¼”å”±ä¼š"
```

## 5. éƒ¨ç½²å¼€å‘

### 5.1 æœ¬åœ°å¼€å‘éƒ¨ç½²

#### 5.1.1 å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨æ•°æ®åº“
sudo service postgresql start
sudo service mongodb start

# å¯åŠ¨åç«¯æœåŠ¡
uvicorn src.api.main:app --reload --host 0.0.0.0 --port 8000

# å¯åŠ¨å‰ç«¯æœåŠ¡
npm start
```

#### 5.1.2 æµ‹è¯•éƒ¨ç½²
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test
pytest

# æ£€æŸ¥ä»£ç è´¨é‡
flake8 src/
npm run lint
```

### 5.2 å®¹å™¨åŒ–å¼€å‘

#### 5.2.1 æ„å»ºé•œåƒ
```bash
# æ„å»ºå‰ç«¯é•œåƒ
docker build -t music-vocal-concert-frontend:latest -f Dockerfile.frontend .

# æ„å»ºåç«¯é•œåƒ
docker build -t music-vocal-concert-backend:latest -f Dockerfile.backend .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 music-vocal-concert-frontend:latest
docker run -p 8000:8000 music-vocal-concert-backend:latest
```

#### 5.2.2 Docker Compose
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

## 6. æ–‡æ¡£ç¼–å†™

### 6.1 APIæ–‡æ¡£
```python
# APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
from fastapi import FastAPI
from fastapi.openapi.utils import get_openapi

def custom_openapi():
    if app.openapi_schema:
        return app.openapi_schema
    
    openapi_schema = get_openapi(
        title="Music Vocal Concert API",
        version="1.0.0",
        description="æ¼”å”±ä¼šä¿¡æ¯æ±‡æ€»ç³»ç»ŸAPI",
        routes=app.routes,
    )
    
    app.openapi_schema = openapi_schema
    return app.openapi_schema

app.openapi = custom_openapi
```

### 6.2 ç»„ä»¶æ–‡æ¡£
```typescript
// ç»„ä»¶æ–‡æ¡£
import React from 'react';
import styled from 'styled-components';

/**
 * æ¼”å”±ä¼šå¡ç‰‡ç»„ä»¶
 * 
 * @param {Object} props - ç»„ä»¶å±æ€§
 * @param {Concert} props.concert - æ¼”å”±ä¼šä¿¡æ¯
 * @param {Function} props.onSelect - é€‰æ‹©äº‹ä»¶å¤„ç†å‡½æ•°
 * 
 * @example
 * <ConcertCard concert={concert} onSelect={handleSelect} />
 */
const ConcertCard: React.FC<ConcertCardProps> = ({ concert, onSelect }) => {
  // ç»„ä»¶å®ç°
};
```

## 7. å¼€å‘å·¥å…·

### 7.1 IDEé…ç½®

#### 7.1.1 VS Codeé…ç½®
```json
// .vscode/settings.json
{
  "python.pythonPath": "venv/bin/python",
  "python.linting.enabled": true,
  "python.linting.pylintEnabled": true,
  "python.formatting.provider": "black",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  }
}
```

#### 7.1.2 PyCharmé…ç½®
- **Pythonè§£é‡Šå™¨**: é€‰æ‹©è™šæ‹Ÿç¯å¢ƒ
- **ä»£ç æ£€æŸ¥**: å¯ç”¨PEP8æ£€æŸ¥
- **æ ¼å¼åŒ–**: ä½¿ç”¨Blackæ ¼å¼åŒ–
- **è°ƒè¯•**: é…ç½®è°ƒè¯•å™¨

### 7.2 å¼€å‘è„šæœ¬

#### 7.2.1 å¯åŠ¨è„šæœ¬
```bash
#!/bin/bash
# start-dev.sh

echo "ğŸš€ å¯åŠ¨Music Vocal Concertå¼€å‘ç¯å¢ƒ"
echo "====================================="

# å¯åŠ¨æ•°æ®åº“
echo "å¯åŠ¨æ•°æ®åº“..."
sudo service postgresql start
sudo service mongodb start

# å¯åŠ¨åç«¯æœåŠ¡
echo "å¯åŠ¨åç«¯æœåŠ¡..."
uvicorn src.api.main:app --reload --host 0.0.0.0 --port 8000 &
BACKEND_PID=$!

# å¯åŠ¨å‰ç«¯æœåŠ¡
echo "å¯åŠ¨å‰ç«¯æœåŠ¡..."
npm start &
FRONTEND_PID=$!

echo "âœ… å¼€å‘ç¯å¢ƒå·²å¯åŠ¨"
echo "ğŸ“± å‰ç«¯: http://localhost:3000"
echo "ğŸ”§ åç«¯: http://localhost:8000"
echo "ğŸ“š APIæ–‡æ¡£: http://localhost:8000/docs"
echo ""
echo "ğŸ”§ åœæ­¢æœåŠ¡: kill $BACKEND_PID $FRONTEND_PID"
```

#### 7.2.2 æµ‹è¯•è„šæœ¬
```bash
#!/bin/bash
# test.sh

echo "ğŸ§ª è¿è¡ŒMusic Vocal Concertæµ‹è¯•"
echo "================================="

# å‰ç«¯æµ‹è¯•
echo "è¿è¡Œå‰ç«¯æµ‹è¯•..."
npm test -- --watchAll=false

# åç«¯æµ‹è¯•
echo "è¿è¡Œåç«¯æµ‹è¯•..."
pytest --tb=short -v

# ä»£ç è´¨é‡æ£€æŸ¥
echo "æ£€æŸ¥ä»£ç è´¨é‡..."
flake8 src/
npm run lint

echo "âœ… æµ‹è¯•å®Œæˆ"
```

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**åˆ›å»ºæ—¶é—´**: 2026-02-08
**æœ€åæ›´æ–°**: 2026-02-08 23:57:00